{
 "name": "Covid19 Registration",
 "id": "23122232-a56a-4639-a3c7-ad8b3594d137",
 "scenario_trigger": "covid19_register",
 "description": "Register internal employees",
 "active": true,
 "updated": "2020-04-30T05:24:21.2480000Z",
 "userDisplayName": "Dr. Sohil",
 "code": "{\"version\":3,\"steps\":[{\"id\":\"449c71ec968a-3ca374f4561c2786-8441\",\"type\":\"action\",\"label\":\"Action\",\"designer\":{\"xLocation\":429,\"yLocation\":0,\"next\":\"0831e398909d-f676f8c5b4c98617-5431\"},\"onInit\":\"var userAddr = session.message.address;\\nscenario.userAddress = JSON.stringify(userAddr);\\n\\n//Get Azure AD Object ID\\nscenario.userInfo = session.message.address.user;\\nscenario.userName = scenario.userInfo.name;\\nconst objectId = scenario.userInfo.aadObjectId;\\nscenario.baseURL = 'https://graph.microsoft.com/v1.0/users/' + objectId;\\n\\n//Get Azure tenant ID\\nscenario.tenantId = JSON.parse(JSON.stringify(session.message.address.conversation)).tenantId;\\n\"},{\"id\":\"0831e398909d-f676f8c5b4c98617-5431\",\"type\":\"statement\",\"designer\":{\"xLocation\":427,\"yLocation\":69,\"next\":\"b9b6ffbb026a-d6f7d7685afe75a4-bdb7\"},\"text\":\"\\\"Welcome \\\" + scenario.userName +\\\" to Contoso Health Systems! Please enter the following details for a one-time registration.\\\"\",\"stringId\":\"stringId_e4bd128701e5bb1c\",\"label\":\"Welcome\"},{\"id\":\"f48ea8a15623-8bf1eea7fe404348-e009\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":428,\"yLocation\":269,\"next\":\"161f653b65ea-468238bd621e3891-77a3\"},\"variable\":\"userInfoInput\",\"submitTitle\":\"Submit\",\"stringId\":\"\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"version\\\": \\\"1.0\\\",\\r\\n    \\\"body\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"size\\\": \\\"Medium\\\",\\r\\n            \\\"text\\\": \\\"Last Name: \\\" + scenario.userProfile.surname\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"size\\\": \\\"Medium\\\",\\r\\n            \\\"text\\\": \\\"First Name: \\\" + scenario.userProfile.givenName \\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"size\\\": \\\"Medium\\\",\\r\\n            \\\"text\\\": \\\"Role: \\\" + scenario.userProfile.jobTitle \\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"size\\\": \\\"Medium\\\",\\r\\n            \\\"text\\\": \\\"Mobile: \\\" + scenario.userProfile.mobilePhone\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"size\\\": \\\"Medium\\\",\\r\\n            \\\"text\\\": \\\"Email: \\\" + scenario.userProfile.mail\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.Text\\\",\\r\\n            \\\"placeholder\\\": \\\"Age\\\",\\r\\n            \\\"style\\\": \\\"text\\\",\\r\\n            \\\"maxLength\\\": 0,\\r\\n            \\\"id\\\": \\\"age\\\"\\r\\n        }\\r\\n    ],\\r\\n    \\\"actions\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"Action.Submit\\\",\\r\\n            \\\"title\\\": \\\"Submit\\\",\\r\\n            \\\"data\\\": {\\r\\n                \\\"id\\\": \\\"101\\\"\\r\\n            }\\r\\n        }\\r\\n    ]\\r\\n}\"}],\"label\":\"Get user profile\"},{\"id\":\"53807871934a-1b72cc0760fddf1a-d086\",\"type\":\"statement\",\"designer\":{\"xLocation\":427,\"yLocation\":420},\"text\":\"Thank you! Your details are recorded.\",\"stringId\":\"stringId_8afcada52f1d0cb2\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"version\\\": \\\"1.0\\\",\\r\\n    \\\"body\\\": [        \\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Summary: Here is what you said\\\",\\r\\n            \\\"id\\\": \\\"summary\\\",\\r\\n            \\\"weight\\\":\\\"bolder\\\",\\r\\n            \\\"size\\\":\\\"large\\\",\\r\\n            \\\"horizontalAlignment\\\": \\\"Left\\\"\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Employee ID: \\\" + scenario.userInfoInput.employeeID + \\\", Age: \\\" + scenario.userInfoInput.age,\\r\\n            \\\"wrap\\\": true,\\r\\n            \\\"separator\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Existing chronic illness: \\\" + scenario.chronicInput.choices,\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Current medications: \\\" + scenario.chronicInput.medicationschoices,\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Thermometer: \\\" + scenario.deviceInput.isThermometerHandychoices + \\\", Delivery Address: \\\" + scenario.deviceInput.thermoDeliveryAddress,\\r\\n            \\\"wrap\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"O2 Saturation Monitor: \\\" + scenario.deviceInput.isO2SatMonitorHandychoices + \\\", Delivery Address: \\\" + scenario.deviceInput.o2DeliveryAddress,\\r\\n            \\\"wrap\\\": true\\r\\n        }\\r\\n    ]\\r\\n}\"}]},{\"id\":\"a45d4c810a6a-af6071965e4a8e10-c273\",\"type\":\"datasource\",\"designer\":{\"xLocation\":427,\"yLocation\":220,\"next\":\"f48ea8a15623-8bf1eea7fe404348-e009\"},\"dataConnection\":\"\",\"urlBase\":\"scenario.baseURL\",\"urlPath\":\"\",\"urlParams\":\"\",\"method\":\"get\",\"headers\":\"{\\r\\n    \\\"Authorization\\\": scenario.accessToken\\r\\n}   \\r\\n\\r\\n\\r\\n\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"userProfile\",\"label\":\"User Profile|Graph API\"},{\"id\":\"161f653b65ea-468238bd621e3891-77a3\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":426,\"yLocation\":320,\"next\":\"ca21412c64ed-14e675bada256afe-4926\"},\"variable\":\"chronicInput\",\"submitTitle\":\"Submit\",\"stringId\":\"\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"version\\\": \\\"1.0\\\",\\r\\n    \\\"body\\\": [\\r\\n        \\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Do you have any of the following?\\\",\\r\\n            \\\"id\\\": \\\"chronicDisease\\\",\\r\\n            \\\"separator\\\": true,\\r\\n            \\\"horizontalAlignment\\\": \\\"Left\\\"\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n            \\\"id\\\": \\\"choices\\\",\\r\\n            \\\"value\\\": \\\"2\\\",\\r\\n            \\\"choices\\\": [\\r\\n                {\\r\\n                    \\\"title\\\": \\\"Heart disease\\\",\\r\\n                    \\\"value\\\": \\\"Heart disease\\\"\\r\\n                },\\r\\n                {\\r\\n                    \\\"title\\\": \\\"Asthma\\\",\\r\\n                    \\\"value\\\": \\\"Asthma\\\"\\r\\n                },\\r\\n                {\\r\\n                    \\\"title\\\": \\\"Chronic lung problems including COPD\\\",\\r\\n                    \\\"value\\\": \\\"Chronic lung problems including COPD\\\"\\r\\n                },\\r\\n                {\\r\\n                    \\\"title\\\": \\\"Cancer\\\",\\r\\n                    \\\"value\\\": \\\"Cancer\\\"\\r\\n                },\\r\\n                {\\r\\n                    \\\"title\\\": \\\"Diabetes\\\",\\r\\n                    \\\"value\\\": \\\"Diabetes\\\"\\r\\n                }\\r\\n            ],\\r\\n            \\\"wrap\\\": true,\\r\\n            \\\"style\\\": \\\"expanded\\\",\\r\\n            \\\"placeholder\\\": \\\"\\\",\\r\\n            \\\"isMultiSelect\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Are you taking any medications:\\\",\\r\\n            \\\"id\\\": \\\"medications\\\",\\r\\n            \\\"separator\\\": true,\\r\\n            \\\"wrap\\\":true,\\r\\n            \\\"horizontalAlignment\\\": \\\"Left\\\"\\r\\n        },        \\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n            \\\"id\\\": \\\"medicationschoices\\\",\\r\\n            \\\"value\\\": \\\"2\\\",\\r\\n            \\\"choices\\\": [\\r\\n                {\\r\\n                    \\\"title\\\": \\\"that may cause immunosuppression such as chemotherapy\\\",\\r\\n                    \\\"value\\\": \\\"Chemotherapy\\\",\\r\\n                    \\\"wrap\\\": true\\r\\n                },\\r\\n                {\\r\\n                    \\\"title\\\": \\\"for rheumatoid arthritis\\\",\\r\\n                    \\\"value\\\": \\\"Rheumatoid arthritis\\\",\\r\\n                    \\\"wrap\\\":true\\r\\n                }\\r\\n            ],\\r\\n            \\\"wrap\\\": true,\\r\\n            \\\"style\\\": \\\"expanded\\\",\\r\\n            \\\"placeholder\\\": \\\"\\\",\\r\\n            \\\"isMultiSelect\\\": true\\r\\n        }\\r\\n    ],\\r\\n    \\\"actions\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"Action.Submit\\\",\\r\\n            \\\"title\\\": \\\"Submit\\\",\\r\\n            \\\"data\\\": {\\r\\n                \\\"id\\\": \\\"102\\\"\\r\\n            }\\r\\n        }\\r\\n    ]\\r\\n}\"}],\"label\":\"Get underlying info\"},{\"id\":\"ca21412c64ed-14e675bada256afe-4926\",\"type\":\"prompt\",\"dataType\":\"object\",\"designer\":{\"xLocation\":427,\"yLocation\":368,\"next\":\"53807871934a-1b72cc0760fddf1a-d086\"},\"variable\":\"deviceInput\",\"submitTitle\":\"Submit\",\"stringId\":\"\",\"layout\":\"vertical\",\"attachment\":[{\"type\":\"AdaptiveCard\",\"cardCode\":\"{\\r\\n    \\\"$schema\\\": \\\"http://adaptivecards.io/schemas/adaptive-card.json\\\",\\r\\n    \\\"type\\\": \\\"AdaptiveCard\\\",\\r\\n    \\\"version\\\": \\\"1.0\\\",\\r\\n    \\\"body\\\": [\\r\\n        \\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Do you have a Thermometer at home?\\\",\\r\\n            \\\"id\\\": \\\"isThermometerHandy\\\",\\r\\n            \\\"separator\\\": true,\\r\\n            \\\"horizontalAlignment\\\": \\\"Left\\\"\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n            \\\"id\\\": \\\"isThermometerHandychoices\\\",\\r\\n            \\\"value\\\": \\\"1\\\",\\r\\n            \\\"choices\\\": [\\r\\n                {\\r\\n                    \\\"title\\\": \\\"Yes\\\",\\r\\n                    \\\"value\\\": \\\"Yes\\\"\\r\\n                },\\r\\n                {\\r\\n                    \\\"title\\\": \\\"No\\\",\\r\\n                    \\\"value\\\": \\\"No\\\"\\r\\n                }\\r\\n            ],\\r\\n            \\\"wrap\\\": true,\\r\\n            \\\"style\\\": \\\"expanded\\\",\\r\\n            \\\"placeholder\\\": \\\"\\\"\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.Text\\\",\\r\\n            \\\"placeholder\\\": \\\"If No, please enter Delivery Address\\\",\\r\\n            \\\"style\\\": \\\"text\\\",\\r\\n            \\\"isMultiline\\\": false,\\r\\n            \\\"maxLength\\\": 0,\\r\\n            \\\"id\\\": \\\"thermoDeliveryAddress\\\",\\r\\n            \\\"isVisible\\\": true\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"TextBlock\\\",\\r\\n            \\\"text\\\": \\\"Do you have an O2 Saturation Monitor at home?\\\",\\r\\n            \\\"id\\\": \\\"isO2SatMonitorHandy\\\",\\r\\n            \\\"separator\\\": true,\\r\\n            \\\"horizontalAlignment\\\": \\\"Left\\\"\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.ChoiceSet\\\",\\r\\n            \\\"id\\\": \\\"isO2SatMonitorHandychoices\\\",\\r\\n            \\\"value\\\": \\\"1\\\",\\r\\n            \\\"choices\\\": [\\r\\n                {\\r\\n                    \\\"title\\\": \\\"Yes\\\",\\r\\n                    \\\"value\\\": \\\"Yes\\\"\\r\\n                },\\r\\n                {\\r\\n                    \\\"title\\\": \\\"No\\\",\\r\\n                    \\\"value\\\": \\\"No\\\"\\r\\n                }\\r\\n            ],\\r\\n            \\\"wrap\\\": true,\\r\\n            \\\"style\\\": \\\"expanded\\\",\\r\\n            \\\"placeholder\\\": \\\"\\\"\\r\\n        },\\r\\n        {\\r\\n            \\\"type\\\": \\\"Input.Text\\\",\\r\\n            \\\"placeholder\\\": \\\"If No, please enter Delivery Address\\\",\\r\\n            \\\"style\\\": \\\"text\\\",\\r\\n            \\\"isMultiline\\\": false,\\r\\n            \\\"maxLength\\\": 0,\\r\\n            \\\"id\\\": \\\"o2DeliveryAddress\\\",\\r\\n            \\\"isVisible\\\": true\\r\\n        }\\r\\n    ],\\r\\n    \\\"actions\\\": [\\r\\n        {\\r\\n            \\\"type\\\": \\\"Action.Submit\\\",\\r\\n            \\\"title\\\": \\\"Submit\\\",\\r\\n            \\\"data\\\": {\\r\\n                \\\"id\\\": \\\"103\\\"\\r\\n            }\\r\\n        }\\r\\n    ]\\r\\n}\"}],\"label\":\"Get device info\"},{\"id\":\"b9b6ffbb026a-d6f7d7685afe75a4-bdb7\",\"type\":\"datasource\",\"designer\":{\"xLocation\":426,\"yLocation\":120,\"next\":\"a158c18f381b-869a6bdb88b5ee45-0336\"},\"dataConnection\":\"\",\"urlBase\":\"'https://login.microsoftonline.com/' + scenario.tenantId + '/oauth2/v2.0/token'\",\"urlPath\":\"\",\"urlParams\":\"\",\"contentType\":\"raw\",\"method\":\"post\",\"headers\":\"{\\r\\n    \\\"Content-Type\\\":\\\"application/x-www-form-urlencoded\\\"\\r\\n}\",\"payload\":\"'grant_type=client_credentials&client_id=92648ab3-6496-476b-bc27-9b4c53b68833&client_secret=Q=]7=AlY/VF7HhQVBzgRe2gW9S5kcTL0&scope=https://graph.microsoft.com/.default'\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"oauthToken\",\"error\":\"oauthError\",\"label\":\"OAuth Token|GraphAPI\"},{\"id\":\"a158c18f381b-869a6bdb88b5ee45-0336\",\"type\":\"assignVariable\",\"designer\":{\"xLocation\":427,\"yLocation\":169,\"next\":\"a45d4c810a6a-af6071965e4a8e10-c273\"},\"scope\":\"scenario\",\"operation\":\"set\",\"variable\":\"accessToken\",\"value\":\"\\\"Bearer \\\" + scenario.oauthToken.access_token\"}],\"interrupting\":false,\"breaking\":false,\"returningMessage\":\"\"}"
}